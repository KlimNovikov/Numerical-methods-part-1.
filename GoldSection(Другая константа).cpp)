#include <iostream>

//------------------------------------------------------------------------------
// Функция: GoldSection
// Описание:
//   Находит точку минимума функции F на отрезке [a, b] методом золотого сечения
//   с заданной точностью eps.
// Формат входных данных:
//   double a, b    - границы отрезка поиска минимума (a < b).
//   double (*F)(double) - указатель на функцию F(x), минимум которой ищем.
//   double eps     - требуемая точность.
// Формат выходных данных:
//   Возвращает приближённое значение точки x*, в которой достигается минимум.
//
// Примечание по поводу "золотого" коэффициента:
//   Золотое отношение r = (sqrt(5) - 1) / 2 ≈ 0.61803
//------------------------------------------------------------------------------
double GoldSection(double a, double b, double (*F)(double), double eps)
{
    // Золотое отношение
    const double r = (std::sqrt(5.0) - 1.0) / 2.0;
    // Первичное вычисление внутренних точек
    double c = b - r * (b - a);
    double d = a + r * (b - a);

    // Пока длина текущего интервала [a,b] больше eps, сужаем его
    while ((b - a) > eps) {
        if (F(c) > F(d)) {
            // Минимум лежит в [c, b]
            a = c;
            c = d;
            d = a + r * (b - a);
        }
        else {
            // Минимум лежит в [a, d]
            b = d;
            d = c;
            c = b - r * (b - a);
        }
    }
    // Возвращаем середину текущего отрезка как оценку минимума
    return 0.5 * (a + b);
}

//------------------------------------------------------------------------------
// Пример тестируемой функции
//   F(x) = (x - 2)^2 + 1
// Минимум достигается при x = 2, значение минимума F(2) = 1
//------------------------------------------------------------------------------
double TestFunction(double x) {
    return (x - 2.0) * (x - 2.0) + 1.0;
}

//------------------------------------------------------------------------------
// Тестовый пример
//------------------------------------------------------------------------------
int main()
{
    // Задаём отрезок и точность
    double a = 0.0;
    double b = 6.0;
    double eps = 1e-8;

    // Ищем минимум на [0,6] для функции TestFunction
    double x_min = GoldSection(a, b, TestFunction, eps);

    // Выводим результаты
    std::cout << "Find minimum of the function F(x) = (x-2)^2 + 1 on the section ["
        << a << ", " << b << "].\n";
    std::cout << "Point of minimum x* = " << x_min << std::endl;
    std::cout << "Value F(x*) = " << TestFunction(x_min) << std::endl;

    return 0;
}
